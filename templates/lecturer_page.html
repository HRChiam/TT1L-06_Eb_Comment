<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width = device-width, initial-scale = 1">
    <title>Lecturer Details</title>
    <link href="../static/student.css" rel="stylesheet">
</head>

<body>
    <header>
        <div class="header_container">
            <div class="text-container">
                <div class="hamburger" onclick="toggleMenu()">
                    <div class="line"></div>
                    <div class="line"></div>
                    <div class="line"></div>
                </div>
                <span id="MM">MM</span>
                <span id="U">U</span>
            </div>
            <div class="bar-container">
                <div class="blue-bar2"></div>
                <div class="red-bar2"></div>
            </div>
            <span id="header_webname">Eb_Comment</span>
            <nav class="menu_container" id="menuContainer">
                <a href="#">Cyberjaya</a>
                <div class="submenu">
                    <a href="/faculty/FCI">FCI</a>
                    <a href="/faculty/FOM">FOM</a>
                    <a href="/faculty/FOE">FOE</a>
                    <a href="/faculty/FCM">FCM</a>
                    <a href="/faculty/FCA">FCA</a>
                    <a href="/faculty/FAC">FAC</a>
                </div>
                <a href="#">Melaka</a>
                <div class="submenu">
                    <a href="/faculty/FIST">FIST</a>
                    <a href="/faculty/FOB">FOB</a>
                    <a href="/faculty/FOL">FOL</a>
                    <a href="/faculty/FET">FET</a>
                </div>
                <a href="/keyin">Upload Lecturer Information</a>
                {% if current_user.is_authenticated %}
                <a href="{{ url_for('logout') }}">Logout</a>
                {% else %}
                <a href="{{ url_for('login') }}">Login</a>
                {% endif %}
            </nav>
        </div>
    </header>

    <script>
        function toggleMenu() {
            var menuContainer = document.getElementById('menuContainer');
            menuContainer.classList.toggle('active');
        }

        var menuItems = document.querySelectorAll('.menu_container a');
        menuItems.forEach(function (menuItem) {
            menuItem.addEventListener('click', function () {
                var submenu = menuItem.nextElementSibling;
                if (submenu && submenu.classList.contains('submenu')) {
                    submenu.classList.toggle('active');
                    menuItem.classList.toggle('rotate');
                }
            });
        });
    </script>

    <div class="lecturer_details_container">
        <div class="lecturer_info">
            <h2>{{ lecturer.name }} - Details</h2>
            <img src="{{ url_for('static', filename='uploads/' + lecturer.photo) }}" alt="{{ lecturer.name }}">
            <p><strong>Name:</strong> {{ lecturer.name }}</p>
            <p><strong>Phone:</strong> {{ lecturer.phone }}</p>
            <p><strong>Email:</strong> {{ lecturer.email }}</p>
            <p><strong>Campus:</strong> {{ lecturer.campus }}</p>
            <p><strong>Bio:</strong> {{ lecturer.bio }}</p>
        </div>

        <div class="comments_section">
            <h3>Leave your comment here:</h3>
            <form id="comment_form" action="{{ url_for('add_comment') }}" method="POST">
                <input type="hidden" name="lecturer_id" value="{{ lecturer.id }}">
                <input type="hidden" name="nickname" id="nickname_input" required>

                <div>
                    <label for="comment_text">Comment:</label>
                    <textarea id="comment_textarea" name="comment_text" required></textarea>
                </div>
                <button type="submit">Add Comment</button>
            </form>

            <div class="comments_list">
                {% for comment in comments %}
                <div class="comment">
                    <p><strong>{{ comment.nickname }}</strong> ({{ comment.date }} {{ comment.time }}):</p>
                    <p>{{ comment.comment_text }}</p>
                    <div>
                        <form action="{{ url_for('upvote_comment', comment_id=comment.id) }}" method="post">
                            <button type="submit">Thumbs Up</button>
                        </form>
                        <form action="{{ url_for('downvote_comment', comment_id=comment.id) }}" method="post">
                            <button type="submit">Thumbs Down</button>
                        </form>
                        <p>Agree: {{ comment.thumbs_up }} ({{ comment.agree_percentage }}%)</p>
                        <p>Disagree: {{ comment.thumbs_down }} ({{ comment.disagree_percentage }}%)</p>
                    </div>
                </div>
                {% endfor %}

            </div>
        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var commentTextarea = document.getElementById("comment_textarea");
            var nicknameInput = document.getElementById("nickname_input");

            commentTextarea.addEventListener("focus", showNicknameField);
            commentTextarea.addEventListener("input", showNicknameField);

            function showNicknameField() {
                nicknameInput.style.display = "block";
            }
        });
    </script>

</body>

</html>